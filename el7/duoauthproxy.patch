diff -u -r source/pkgs/duoauthproxy/duoauthproxy/lib/util.py patched/pkgs/duoauthproxy/duoauthproxy/lib/util.py
--- source/pkgs/duoauthproxy/duoauthproxy/lib/util.py	2020-08-14 17:12:21.000000000 -0400
+++ patched/pkgs/duoauthproxy/duoauthproxy/lib/util.py	2020-08-19 10:15:08.000000000 -0400
@@ -195,7 +195,7 @@
         # This local file is <AUTHPROXY_INSTALL_DIR>/usr/local/lib/python2.7/site-packages/duoauthproxy/lib/util.py.
         # Find <AUTHPROXY_INSTALL_DIR>.
         _home_dir = os.path.abspath(
-            os.path.join(os.path.dirname(__file__), *[".."] * 7)
+            os.path.join(os.path.dirname(__file__), *[".."] * 5)
         )
 
 
diff -u -r source/pkgs/duoauthproxy/scripts/authproxy_update_sso_enrollment_code patched/pkgs/duoauthproxy/scripts/authproxy_update_sso_enrollment_code
--- source/pkgs/duoauthproxy/scripts/authproxy_update_sso_enrollment_code	2020-08-14 17:12:22.000000000 -0400
+++ patched/pkgs/duoauthproxy/scripts/authproxy_update_sso_enrollment_code	2020-08-19 10:16:23.000000000 -0400
@@ -10,10 +10,7 @@
 from duoauthproxy.lib import const, log, util
 from duoauthproxy.lib.secret_storage import get_storage_filename, store_secret
 
-# --- install script will customize this ---
-USER_DEFAULT = None
-# ------------------------------------------
-
+USER_DEFAULT = 'root'
 
 def set_linux_permissions():
     import pwd
diff -u -r source/pkgs/duoauthproxy/scripts/authproxyctl patched/pkgs/duoauthproxy/scripts/authproxyctl
--- source/pkgs/duoauthproxy/scripts/authproxyctl	2020-08-14 17:12:22.000000000 -0400
+++ patched/pkgs/duoauthproxy/scripts/authproxyctl	2020-08-19 10:20:41.000000000 -0400
@@ -85,9 +85,7 @@
 
 class LinuxAuthproxyController(AuthproxyController):
 
-    # --- install script will customize this ---
-    USER_DEFAULT = None
-    # ------------------------------------------
+    USER_DEFAULT = 'root'
 
     # linux standard status codes for 'status' initscript command
     STATUS_RUNNING = 0
@@ -103,7 +101,7 @@
             python_root = os.path.abspath(root_relative)
 
         if duo_root is None:
-            root_relative = os.path.join(os.path.dirname(script_abspath), *[".."] * 3)
+            root_relative = os.path.join(os.path.dirname(script_abspath), "..")
             duo_root = os.path.abspath(root_relative)
 
         super(LinuxAuthproxyController, self).__init__(duo_root)
diff -u -r source/pkgs/duoauthproxy/scripts/duoauthproxy.tap patched/pkgs/duoauthproxy/scripts/duoauthproxy.tap
--- source/pkgs/duoauthproxy/scripts/duoauthproxy.tap	2020-08-14 17:12:22.000000000 -0400
+++ patched/pkgs/duoauthproxy/scripts/duoauthproxy.tap	2020-08-19 10:21:24.000000000 -0400
@@ -1,8 +1,6 @@
 from duoauthproxy import proxy
 
-# --- install script will customize this ---
-USER_DEFAULT = None
-GROUP_DEFAULT = None
-# ------------------------------------------
+USER_DEFAULT = 'root'
+GROUP_DEFAULT = 'root'
 
 application = proxy.create_application(twistd_user=USER_DEFAULT, log_group=GROUP_DEFAULT)
diff -u -r source/pkgs/duoauthproxy/setup.py patched/pkgs/duoauthproxy/setup.py
--- source/pkgs/duoauthproxy/setup.py	2020-08-14 17:12:22.000000000 -0400
+++ patched/pkgs/duoauthproxy/setup.py	2020-08-19 10:22:13.000000000 -0400
@@ -152,11 +152,11 @@
         scripts=[
             "scripts/authproxy",
             "scripts/authproxyctl",
-            "scripts/install",
             "scripts/authproxy_connectivity_tool",
             "scripts/authproxy_primary_only",
             "scripts/authproxy_support",
             "scripts/authproxy_update_sso_enrollment_code",
+            'scripts/duoauthproxy.tap',
         ],
         **common_metadata
     )
diff -u -r source/pkgs/pyrad-2.2/pyrad/packet.py patched/pkgs/pyrad-2.2/pyrad/packet.py
--- source/pkgs/pyrad-2.2/pyrad/packet.py	2020-08-14 17:12:20.000000000 -0400
+++ patched/pkgs/pyrad-2.2/pyrad/packet.py	2020-08-19 10:24:51.000000000 -0400
@@ -632,9 +632,9 @@
         if self.authenticator is None:
             # self.authenticator = self.CreateAuthenticator()
             self.authenticator = 16 * six.b('\x00')
-
-        salt = struct.pack('!H', random_generator.randrange(0, 65535))
-        salt = chr(ord(salt[0]) | 1 << 7)+salt[1]
+        
+        salt = struct.pack('!H', 32768 + random_generator.randrange(0, 32767) )
+        salt = chr(salt[0]) + chr(salt[1])
 
         length = struct.pack("B", len(value))
         buf = length + value
@@ -643,7 +643,7 @@
 
         result = six.b(salt)
 
-        last = self.authenticator + salt
+        last = self.authenticator + six.b(salt)
         while buf:
             hash = md5_constructor(self.secret + last).digest()
             if six.PY3:
